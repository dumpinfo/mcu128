Counter		EQU	59H	;ʾ֪ͨʾĸ
FIRST		EQU	P2.7	;һλܵλ
SECOND  	EQU	P2.6	;ڶλܵλ
DISPBUFF	EQU	5AH	;ʾΪ5AH5BH
	ORG	0000H
	AJMP	START
	ORG	000BH		;ʱT0
	AJMP	DISP		;ʾ
	ORG	30H
START:
	MOV	SP,#5FH		;öջ
	MOV	P1,#0FFH
	MOV	P0,#0FFH
	MOV	P2,#0FFH	;ʼʾLED
	MOV	TMOD,#00000001B	;ʱT0ģʽ116λʱ/ģʽ
	MOV	TH0,#HIGH(65536-2000)
	MOV	TL0,#LOW(65536-2000)
	SETB	TR0
	SETB	EA
	SETB	ET0
	MOV	Counter,#0	;ʼ
	MOV	DISPBUFF,#0	;һλʼʾ0
	MOV	A,#0
LOOP:	
	MOV	DISPBUFF+1,A	;ڶλʾ0-9
	INC	A
	LCALL	DELAY
	CJNE	A,#10,LOOP
	MOV	A,#0
	AJMP	LOOP
;򵽴˽
DISP:
	PUSH	ACC		;ACCջ
	PUSH	PSW		;PSWջ
	MOV	TH0,#HIGH(65536-2000)
	MOV	TL0,#LOW(65536-2000)
	SETB	FIRST
	SETB	SECOND		;ʾ
	MOV	A,#DISPBUFF	;ʾ׵ַ
	ADD	A,Counter	
	MOV	R0,A
	MOV	A,@R0		;ݼֵȡӦʾֵ
	MOV	DPTR,#DISPTAB	;α׵ַ
	MOVC	A,@A+DPTR	;ȡ
	MOV	P0,A		;P0λοڣ
	MOV	A,Counter	;ȡֵ
	JZ	DISPFIRST	;0ʾһλ
	CLR	SECOND		;ʾڶλ
	AJMP	DISPSECOND
DISPFIRST:
	CLR	FIRST		;ʾһλ		
DISPSECOND:
	INC	Counter		;1
	MOV	A,Counter	
	DEC	A		;Ƶ20
	DEC	A		
	JZ	RSTCOUNT	
	AJMP	DISPNEXT
RSTCOUNT:
	MOV	Counter,#0	;ֵֻ01
DISPNEXT:

	POP	PSW
	POP	ACC
	RETI
DELAY:			;ʱ130
	PUSH	PSW
	SETB	RS0
	MOV	R7,#255
D1:	MOV	R6,#255
D2:	NOP
	NOP
	NOP
	NOP
	DJNZ	R6,D2
	DJNZ	R7,D1
	POP	PSW
	RET
DISPTAB:DB 28H,7EH,0a4H,64H,72H,61H,21H,7CH,20H,60H	
	END
